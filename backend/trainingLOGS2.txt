================================================================================
GOOGLE COLAB VIT TRAINING SETUP
================================================================================
âœ… GPU Available: Tesla T4
âœ… GPU Memory: 15.8 GB

ğŸ“Š Dataset structure:
   notumor: 22101 images
   glioma: 24156 images
   meningioma: 23431 images
   pituitary: 20153 images

âœ… Total images found: 89841

================================================================================

ğŸš€ Starting training with parameters:
   Dataset: /content/dataset/Vit_Dataset
   Batch size: 32
   Epochs: 50
   Learning rate: 0.0001
   Image size: 224x224
   Train split: 0.8
   Data augmentation: True
   Early stopping patience: 10

ğŸ“ Loading dataset...
âœ… Total dataset loaded: 89841 samples
   Training samples: 71872
   Validation samples: 17969
   Class distribution (train): [17576 19361 18845 16090]

ğŸ“Š BASE DATASET SIZE: 89841 images
   (Note: Augmentation is applied on-the-fly during training, not pre-computed)
   Each training epoch will see augmented variations of these images
âœ… Dataloaders created: 2246 train batches, 562 val batches

ğŸ§  Creating ViT model...
   Device: cuda
   Model: vit_base_patch16_224
   Number of classes: 4
   Total parameters: 85,801,732
   Trainable parameters: 85,801,732
/content/BTSC-UNet-ViT/train_vit_colab.py:234: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = GradScaler() if self.use_mixed_precision else None

ğŸ‹ï¸  Trainer Configuration:
   Device: cuda
   Learning rate: 0.0001
   Optimizer: AdamW (weight_decay=0.01)
   Scheduler: ReduceLROnPlateau (patience=5, factor=0.5)
   Early stopping: patience=10
   Mixed precision: True
   Gradient clipping: enabled (max_norm=1.0)

ğŸ’¡ Tips:
   - Training visualizations saved to: /content/checkpoints
   - Best model will be saved as: /content/checkpoints/vit_best.pth
   - Monitor GPU usage with: !nvidia-smi
   - Training may take 2-4 hours for 50 epochs


================================================================================
STARTING TRAINING
================================================================================
Epoch 01 [Train]:   0% 0/2246 [00:00<?, ?it/s]/content/BTSC-UNet-ViT/train_vit_colab.py:269: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 01 [Train]: 100% 2246/2246 [11:14<00:00,  3.33it/s, loss=0.0411, acc=89.44%]
Epoch 01 [Val]  : 100% 562/562 [03:24<00:00,  2.75it/s, loss=0.0196, acc=97.03%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 1/50 Summary:
   Train Loss: 0.2886 | Train Acc: 89.44%
   Val Loss:   0.0891 | Val Acc:   97.03%
   LR: 0.000100
   Time: 878.64s
   ğŸ’¾ Best model saved: val_loss=0.0891, val_acc=97.03%
Epoch 02 [Train]: 100% 2246/2246 [11:21<00:00,  3.29it/s, loss=0.0092, acc=96.26%]
Epoch 02 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0435, acc=97.43%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 2/50 Summary:
   Train Loss: 0.1153 | Train Acc: 96.26%
   Val Loss:   0.0842 | Val Acc:   97.43%
   LR: 0.000100
   Time: 885.68s
   ğŸ’¾ Best model saved: val_loss=0.0842, val_acc=97.43%
Epoch 03 [Train]: 100% 2246/2246 [11:11<00:00,  3.35it/s, loss=0.0108, acc=97.20%]
Epoch 03 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0039, acc=98.42%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 3/50 Summary:
   Train Loss: 0.0890 | Train Acc: 97.20%
   Val Loss:   0.0534 | Val Acc:   98.42%
   LR: 0.000100
   Time: 875.04s
   ğŸ’¾ Best model saved: val_loss=0.0534, val_acc=98.42%
Epoch 04 [Train]: 100% 2246/2246 [11:09<00:00,  3.35it/s, loss=0.0025, acc=97.60%]
Epoch 04 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0045, acc=98.01%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 4/50 Summary:
   Train Loss: 0.0769 | Train Acc: 97.60%
   Val Loss:   0.0633 | Val Acc:   98.01%
   LR: 0.000100
   Time: 873.44s
   EarlyStopping counter: 1/10
Epoch 05 [Train]: 100% 2246/2246 [10:55<00:00,  3.42it/s, loss=0.0019, acc=97.93%]
Epoch 05 [Val]  : 100% 562/562 [03:24<00:00,  2.74it/s, loss=0.0902, acc=96.88%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 5/50 Summary:
   Train Loss: 0.0667 | Train Acc: 97.93%
   Val Loss:   0.1056 | Val Acc:   96.88%
   LR: 0.000100
   Time: 860.64s
   EarlyStopping counter: 2/10
Epoch 06 [Train]: 100% 2246/2246 [10:54<00:00,  3.43it/s, loss=0.0213, acc=98.18%]
Epoch 06 [Val]  : 100% 562/562 [03:24<00:00,  2.75it/s, loss=0.0005, acc=98.45%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 6/50 Summary:
   Train Loss: 0.0617 | Train Acc: 98.18%
   Val Loss:   0.0525 | Val Acc:   98.45%
   LR: 0.000100
   Time: 858.63s
   ğŸ’¾ Best model saved: val_loss=0.0525, val_acc=98.45%
Epoch 07 [Train]: 100% 2246/2246 [10:54<00:00,  3.43it/s, loss=0.0849, acc=98.35%]
Epoch 07 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0003, acc=98.55%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 7/50 Summary:
   Train Loss: 0.0557 | Train Acc: 98.35%
   Val Loss:   0.0544 | Val Acc:   98.55%
   LR: 0.000100
   Time: 857.90s
   ğŸ’¾ Best model saved: val_loss=0.0544, val_acc=98.55%
   EarlyStopping counter: 1/10
Epoch 08 [Train]: 100% 2246/2246 [10:53<00:00,  3.44it/s, loss=0.1218, acc=98.46%]
Epoch 08 [Val]  : 100% 562/562 [03:24<00:00,  2.75it/s, loss=0.0024, acc=98.55%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 8/50 Summary:
   Train Loss: 0.0528 | Train Acc: 98.46%
   Val Loss:   0.0558 | Val Acc:   98.55%
   LR: 0.000100
   Time: 857.94s
   ğŸ’¾ Best model saved: val_loss=0.0558, val_acc=98.55%
   EarlyStopping counter: 2/10
Epoch 09 [Train]: 100% 2246/2246 [10:53<00:00,  3.44it/s, loss=0.0035, acc=98.52%]
Epoch 09 [Val]  : 100% 562/562 [03:24<00:00,  2.75it/s, loss=0.0168, acc=99.05%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 9/50 Summary:
   Train Loss: 0.0505 | Train Acc: 98.52%
   Val Loss:   0.0294 | Val Acc:   99.05%
   LR: 0.000100
   Time: 857.82s
   ğŸ’¾ Best model saved: val_loss=0.0294, val_acc=99.05%
Epoch 10 [Train]: 100% 2246/2246 [10:53<00:00,  3.44it/s, loss=0.0005, acc=98.70%]
Epoch 10 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0005, acc=98.65%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 10/50 Summary:
   Train Loss: 0.0444 | Train Acc: 98.70%
   Val Loss:   0.0488 | Val Acc:   98.65%
   LR: 0.000100
   Time: 857.60s
   EarlyStopping counter: 1/10

   ğŸ“Š Training curves saved to: /content/checkpoints/training_curves.png
Epoch 11 [Train]: 100% 2246/2246 [10:54<00:00,  3.43it/s, loss=0.0535, acc=98.65%]
Epoch 11 [Val]  : 100% 562/562 [03:24<00:00,  2.75it/s, loss=0.0007, acc=98.86%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 11/50 Summary:
   Train Loss: 0.0459 | Train Acc: 98.65%
   Val Loss:   0.0426 | Val Acc:   98.86%
   LR: 0.000100
   Time: 859.11s
   EarlyStopping counter: 2/10
Epoch 12 [Train]: 100% 2246/2246 [10:51<00:00,  3.45it/s, loss=0.0044, acc=98.79%]
Epoch 12 [Val]  : 100% 562/562 [03:24<00:00,  2.75it/s, loss=0.0007, acc=98.73%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 12/50 Summary:
   Train Loss: 0.0420 | Train Acc: 98.79%
   Val Loss:   0.0437 | Val Acc:   98.73%
   LR: 0.000100
   Time: 855.94s
   EarlyStopping counter: 3/10
Epoch 13 [Train]: 100% 2246/2246 [10:49<00:00,  3.46it/s, loss=0.1051, acc=98.79%]
Epoch 13 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0002, acc=98.98%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 13/50 Summary:
   Train Loss: 0.0407 | Train Acc: 98.79%
   Val Loss:   0.0411 | Val Acc:   98.98%
   LR: 0.000100
   Time: 853.46s
   EarlyStopping counter: 4/10
Epoch 14 [Train]: 100% 2246/2246 [10:51<00:00,  3.45it/s, loss=0.1423, acc=98.89%]
Epoch 14 [Val]  : 100% 562/562 [03:24<00:00,  2.74it/s, loss=0.0080, acc=98.46%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 14/50 Summary:
   Train Loss: 0.0371 | Train Acc: 98.89%
   Val Loss:   0.0542 | Val Acc:   98.46%
   LR: 0.000100
   Time: 856.16s
   EarlyStopping counter: 5/10
Epoch 15 [Train]: 100% 2246/2246 [10:49<00:00,  3.46it/s, loss=0.0002, acc=98.91%]
Epoch 15 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0014, acc=99.26%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 15/50 Summary:
   Train Loss: 0.0374 | Train Acc: 98.91%
   Val Loss:   0.0290 | Val Acc:   99.26%
   LR: 0.000100
   Time: 852.84s
   ğŸ’¾ Best model saved: val_loss=0.0290, val_acc=99.26%
Epoch 16 [Train]: 100% 2246/2246 [10:47<00:00,  3.47it/s, loss=0.0006, acc=99.02%]
Epoch 16 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0008, acc=98.84%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 16/50 Summary:
   Train Loss: 0.0336 | Train Acc: 99.02%
   Val Loss:   0.0407 | Val Acc:   98.84%
   LR: 0.000100
   Time: 851.55s
   EarlyStopping counter: 1/10
Epoch 17 [Train]: 100% 2246/2246 [10:48<00:00,  3.47it/s, loss=0.0005, acc=99.07%]
Epoch 17 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0025, acc=98.66%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 17/50 Summary:
   Train Loss: 0.0334 | Train Acc: 99.07%
   Val Loss:   0.0548 | Val Acc:   98.66%
   LR: 0.000100
   Time: 851.65s
   EarlyStopping counter: 2/10
Epoch 18 [Train]: 100% 2246/2246 [10:49<00:00,  3.46it/s, loss=0.3206, acc=99.09%]
Epoch 18 [Val]  : 100% 562/562 [03:23<00:00,  2.76it/s, loss=0.0001, acc=99.09%]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Epoch 18/50 Summary:
   Train Loss: 0.0317 | Train Acc: 99.09%
   Val Loss:   0.0386 | Val Acc:   99.09%
   LR: 0.000100
   Time: 853.44s
   EarlyStopping counter: 3/10

