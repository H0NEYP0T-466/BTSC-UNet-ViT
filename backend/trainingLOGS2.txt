================================================================================
GOOGLE COLAB BRAIN UNET TRAINING SETUP
================================================================================
âœ… GPU Available: Tesla T4
âœ… GPU Memory: 15.8 GB

âœ… Dataset found: 126 subjects

ğŸ“Š Sample subject analysis: A00057965
   T1w files: 1
   Mask files: 1
   T1w shape: (256, 256, 192)
   Mask shape: (256, 256, 192)
   Voxel size: (np.float32(1.0), np.float32(1.0), np.float32(0.9999008))

================================================================================

ğŸš€ Starting training with parameters:
   Dataset: /content/NFBS_Dataset
   Batch size: 32
   Epochs: 50
   Learning rate: 0.0001
   Image size: 256x256
   Train split: 0.8
   Cache in memory: True
   Use AMP: True

ğŸ“ Loading dataset...
Missing files in NFBS_Dataset: t1=0, mask=0
Loading slices into memory: 100% 19125/19125 [01:26<00:00, 221.76it/s]
âœ… Dataloaders created:
   Training batches: 479
   Validation batches: 120

ğŸ§  Creating Brain UNet model...
   Device: cuda
   Input channels: 1 (T1w MRI)
   Output channels: 1 (binary brain mask)
   Total parameters: 31,105,953
   Trainable parameters: 31,105,953

ğŸ‹ï¸  Initializing trainer...
   Loss function: Dice + BCE (for brain segmentation)
   Optimizer: Adam with weight decay
   Scheduler: ReduceLROnPlateau
   Mixed Precision: True
/content/BTSC-UNet-ViT/backend/app/models/brain_unet/train_unet.py:62: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler() if self.use_amp else None

================================================================================
STARTING TRAINING
================================================================================

ğŸ’¡ Tips:
   - Training visualizations saved to: /content/checkpoints/brain_unet
   - Best model will be saved as: /content/checkpoints/brain_unet/brain_unet_best.pth
   - Monitor GPU usage with: !nvidia-smi
   - With optimizations, training should be much faster (~5-10 min/epoch)


================================================================================
Epoch 1/50
================================================================================
Epoch 1 [Train]:   0% 0/479 [00:00<?, ?it/s]/content/BTSC-UNet-ViT/backend/app/models/brain_unet/train_unet.py:87: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1 [Train]: 100% 479/479 [02:59<00:00,  2.66it/s, loss=0.4665, dice=0.9815]
Epoch 1 [Val]:   0% 0/120 [00:00<?, ?it/s]/content/BTSC-UNet-ViT/backend/app/models/brain_unet/train_unet.py:158: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1 [Val]: 100% 120/120 [00:15<00:00,  7.81it/s, loss=0.4461, dice=0.9789, iou=0.9587, acc=0.9943]

Epoch 1 Summary:
  Train: loss=0.5152, dice=0.9111, iou=0.0000, acc=0.0000
  Val:   loss=0.4473, dice=0.9793, iou=0.9594, acc=0.9947
  LR: 0.000100
  âœ… Saved best model (dice=0.9793) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 2/50
================================================================================
Epoch 2 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.2541, dice=0.9894]
Epoch 2 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.3371, dice=0.9848, iou=0.9700, acc=0.9960]

Epoch 2 Summary:
  Train: loss=0.3970, dice=0.9806, iou=0.0000, acc=0.0000
  Val:   loss=0.3448, dice=0.9845, iou=0.9694, acc=0.9961
  LR: 0.000100
  âœ… Saved best model (dice=0.9845) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 3/50
================================================================================
Epoch 3 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.2149, dice=0.9854]
Epoch 3 [Val]: 100% 120/120 [00:15<00:00,  7.83it/s, loss=0.2471, dice=0.9877, iou=0.9757, acc=0.9967]

Epoch 3 Summary:
  Train: loss=0.2996, dice=0.9846, iou=0.0000, acc=0.0000
  Val:   loss=0.2563, dice=0.9857, iou=0.9719, acc=0.9964
  LR: 0.000100
  âœ… Saved best model (dice=0.9857) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 4/50
================================================================================
Epoch 4 [Train]: 100% 479/479 [02:59<00:00,  2.66it/s, loss=0.1222, dice=0.9887]
Epoch 4 [Val]: 100% 120/120 [00:15<00:00,  7.86it/s, loss=0.1659, dice=0.9882, iou=0.9767, acc=0.9969]

Epoch 4 Summary:
  Train: loss=0.2115, dice=0.9863, iou=0.0000, acc=0.0000
  Val:   loss=0.1724, dice=0.9867, iou=0.9738, acc=0.9967
  LR: 0.000100
  âœ… Saved best model (dice=0.9867) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 5/50
================================================================================
Epoch 5 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.1139, dice=0.9884]
Epoch 5 [Val]: 100% 120/120 [00:15<00:00,  7.88it/s, loss=0.1105, dice=0.9892, iou=0.9786, acc=0.9971]

Epoch 5 Summary:
  Train: loss=0.1422, dice=0.9880, iou=0.0000, acc=0.0000
  Val:   loss=0.1161, dice=0.9879, iou=0.9762, acc=0.9970
  LR: 0.000100
  âœ… Saved best model (dice=0.9879) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 6/50
================================================================================
Epoch 6 [Train]:   0% 0/479 [00:00<?, ?it/s]/content/BTSC-UNet-ViT/backend/app/models/brain_unet/train_unet.py:87: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 6 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0544, dice=0.9881]
Epoch 6 [Val]:   0% 0/120 [00:00<?, ?it/s]/content/BTSC-UNet-ViT/backend/app/models/brain_unet/train_unet.py:158: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 6 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0646, dice=0.9895, iou=0.9792, acc=0.9972]

Epoch 6 Summary:
  Train: loss=0.0837, dice=0.9882, iou=0.0000, acc=0.0000
  Val:   loss=0.0682, dice=0.9877, iou=0.9758, acc=0.9969
  LR: 0.000100

================================================================================
Epoch 7/50
================================================================================
Epoch 7 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0543, dice=0.9871]
Epoch 7 [Val]: 100% 120/120 [00:15<00:00,  7.86it/s, loss=0.0452, dice=0.9895, iou=0.9792, acc=0.9972]

Epoch 7 Summary:
  Train: loss=0.0561, dice=0.9892, iou=0.0000, acc=0.0000
  Val:   loss=0.0476, dice=0.9888, iou=0.9778, acc=0.9972
  LR: 0.000100
  âœ… Saved best model (dice=0.9888) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 8/50
================================================================================
Epoch 8 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.1155, dice=0.9893]
Epoch 8 [Val]: 100% 120/120 [00:15<00:00,  7.86it/s, loss=1.2675, dice=0.5158, iou=0.3475, acc=0.7506]

Epoch 8 Summary:
  Train: loss=0.0404, dice=0.9898, iou=0.0000, acc=0.0000
  Val:   loss=1.2942, dice=0.5038, iou=0.3371, acc=0.7532
  LR: 0.000100

================================================================================
Epoch 9/50
================================================================================
Epoch 9 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0242, dice=0.9913]
Epoch 9 [Val]: 100% 120/120 [00:15<00:00,  7.86it/s, loss=0.0267, dice=0.9896, iou=0.9794, acc=0.9972]

Epoch 9 Summary:
  Train: loss=0.0313, dice=0.9891, iou=0.0000, acc=0.0000
  Val:   loss=0.0278, dice=0.9890, iou=0.9783, acc=0.9973
  LR: 0.000100
  âœ… Saved best model (dice=0.9890) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 10/50
================================================================================
Epoch 10 [Train]: 100% 479/479 [03:02<00:00,  2.63it/s, loss=0.0179, dice=0.9912]
Epoch 10 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0206, dice=0.9906, iou=0.9815, acc=0.9975]

Epoch 10 Summary:
  Train: loss=0.0238, dice=0.9904, iou=0.0000, acc=0.0000
  Val:   loss=0.0216, dice=0.9900, iou=0.9803, acc=0.9975
  LR: 0.000100
  âœ… Saved best model (dice=0.9900) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 11/50
================================================================================
Epoch 11 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0136, dice=0.9914]
Epoch 11 [Val]: 100% 120/120 [00:15<00:00,  7.88it/s, loss=0.0163, dice=0.9913, iou=0.9827, acc=0.9977]

Epoch 11 Summary:
  Train: loss=0.0191, dice=0.9909, iou=0.0000, acc=0.0000
  Val:   loss=0.0174, dice=0.9903, iou=0.9807, acc=0.9976
  LR: 0.000100
  âœ… Saved best model (dice=0.9903) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 12/50
================================================================================
Epoch 12 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0253, dice=0.9848]
Epoch 12 [Val]: 100% 120/120 [00:15<00:00,  7.88it/s, loss=0.0902, dice=0.9446, iou=0.8951, acc=0.9846]

Epoch 12 Summary:
  Train: loss=0.0163, dice=0.9908, iou=0.0000, acc=0.0000
  Val:   loss=0.0860, dice=0.9451, iou=0.8960, acc=0.9855
  LR: 0.000100

================================================================================
Epoch 13/50
================================================================================
Epoch 13 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0132, dice=0.9904]
Epoch 13 [Val]: 100% 120/120 [00:15<00:00,  7.91it/s, loss=0.0138, dice=0.9905, iou=0.9812, acc=0.9975]

Epoch 13 Summary:
  Train: loss=0.0154, dice=0.9895, iou=0.0000, acc=0.0000
  Val:   loss=0.0142, dice=0.9900, iou=0.9802, acc=0.9975
  LR: 0.000100

================================================================================
Epoch 14/50
================================================================================
Epoch 14 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0107, dice=0.9923]
Epoch 14 [Val]: 100% 120/120 [00:15<00:00,  7.88it/s, loss=0.0123, dice=0.9906, iou=0.9813, acc=0.9975]

Epoch 14 Summary:
  Train: loss=0.0122, dice=0.9914, iou=0.0000, acc=0.0000
  Val:   loss=0.0123, dice=0.9905, iou=0.9812, acc=0.9976
  LR: 0.000100
  âœ… Saved best model (dice=0.9905) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 15/50
================================================================================
Epoch 15 [Train]: 100% 479/479 [03:01<00:00,  2.63it/s, loss=0.0131, dice=0.9915]
Epoch 15 [Val]: 100% 120/120 [00:15<00:00,  7.83it/s, loss=0.0115, dice=0.9908, iou=0.9818, acc=0.9976]

Epoch 15 Summary:
  Train: loss=0.0109, dice=0.9917, iou=0.0000, acc=0.0000
  Val:   loss=0.0115, dice=0.9905, iou=0.9812, acc=0.9976
  LR: 0.000100

================================================================================
Epoch 16/50
================================================================================
Epoch 16 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0079, dice=0.9935]
Epoch 16 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0100, dice=0.9914, iou=0.9829, acc=0.9977]

Epoch 16 Summary:
  Train: loss=0.0097, dice=0.9921, iou=0.0000, acc=0.0000
  Val:   loss=0.0107, dice=0.9904, iou=0.9810, acc=0.9976
  LR: 0.000100

================================================================================
Epoch 17/50
================================================================================
Epoch 17 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0191, dice=0.9823]
Epoch 17 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0115, dice=0.9897, iou=0.9796, acc=0.9973]

Epoch 17 Summary:
  Train: loss=0.0100, dice=0.9912, iou=0.0000, acc=0.0000
  Val:   loss=0.0124, dice=0.9884, iou=0.9770, acc=0.9971
  LR: 0.000100

================================================================================
Epoch 18/50
================================================================================
Epoch 18 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0123, dice=0.9882]
Epoch 18 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0091, dice=0.9916, iou=0.9834, acc=0.9978]

Epoch 18 Summary:
  Train: loss=0.0086, dice=0.9921, iou=0.0000, acc=0.0000
  Val:   loss=0.0098, dice=0.9907, iou=0.9816, acc=0.9977
  LR: 0.000100
  âœ… Saved best model (dice=0.9907) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 19/50
================================================================================
Epoch 19 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0073, dice=0.9933]
Epoch 19 [Val]: 100% 120/120 [00:15<00:00,  7.88it/s, loss=0.0091, dice=0.9914, iou=0.9830, acc=0.9977]

Epoch 19 Summary:
  Train: loss=0.0080, dice=0.9925, iou=0.0000, acc=0.0000
  Val:   loss=0.0098, dice=0.9903, iou=0.9809, acc=0.9976
  LR: 0.000100

================================================================================
Epoch 20/50
================================================================================
Epoch 20 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0085, dice=0.9917]
Epoch 20 [Val]: 100% 120/120 [00:15<00:00,  7.89it/s, loss=0.0100, dice=0.9905, iou=0.9811, acc=0.9975]

Epoch 20 Summary:
  Train: loss=0.0075, dice=0.9927, iou=0.0000, acc=0.0000
  Val:   loss=0.0091, dice=0.9909, iou=0.9820, acc=0.9977
  LR: 0.000100
  âœ… Saved best model (dice=0.9909) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 21/50
================================================================================
Epoch 21 [Train]: 100% 479/479 [03:01<00:00,  2.65it/s, loss=0.0066, dice=0.9943]
Epoch 21 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0083, dice=0.9918, iou=0.9837, acc=0.9978]

Epoch 21 Summary:
  Train: loss=0.0072, dice=0.9929, iou=0.0000, acc=0.0000
  Val:   loss=0.0089, dice=0.9909, iou=0.9819, acc=0.9977
  LR: 0.000100

================================================================================
Epoch 22/50
================================================================================
Epoch 22 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0061, dice=0.9938]
Epoch 22 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0084, dice=0.9916, iou=0.9834, acc=0.9978]

Epoch 22 Summary:
  Train: loss=0.0070, dice=0.9930, iou=0.0000, acc=0.0000
  Val:   loss=0.0088, dice=0.9909, iou=0.9819, acc=0.9977
  LR: 0.000100

================================================================================
Epoch 23/50
================================================================================
Epoch 23 [Train]: 100% 479/479 [03:01<00:00,  2.65it/s, loss=0.0136, dice=0.9837]
Epoch 23 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0095, dice=0.9906, iou=0.9814, acc=0.9975]

Epoch 23 Summary:
  Train: loss=0.0083, dice=0.9914, iou=0.0000, acc=0.0000
  Val:   loss=0.0091, dice=0.9905, iou=0.9811, acc=0.9976
  LR: 0.000100

================================================================================
Epoch 24/50
================================================================================
Epoch 24 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0077, dice=0.9912]
Epoch 24 [Val]: 100% 120/120 [00:15<00:00,  7.86it/s, loss=0.0082, dice=0.9917, iou=0.9836, acc=0.9978]

Epoch 24 Summary:
  Train: loss=0.0068, dice=0.9929, iou=0.0000, acc=0.0000
  Val:   loss=0.0084, dice=0.9912, iou=0.9825, acc=0.9978
  LR: 0.000100
  âœ… Saved best model (dice=0.9912) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 25/50
================================================================================
Epoch 25 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0066, dice=0.9935]
Epoch 25 [Val]: 100% 120/120 [00:15<00:00,  7.84it/s, loss=0.0084, dice=0.9916, iou=0.9834, acc=0.9978]

Epoch 25 Summary:
  Train: loss=0.0063, dice=0.9934, iou=0.0000, acc=0.0000
  Val:   loss=0.0083, dice=0.9913, iou=0.9827, acc=0.9978
  LR: 0.000100
  âœ… Saved best model (dice=0.9913) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 26/50
================================================================================
Epoch 26 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0068, dice=0.9934]
Epoch 26 [Val]: 100% 120/120 [00:15<00:00,  7.91it/s, loss=0.0083, dice=0.9915, iou=0.9831, acc=0.9977]

Epoch 26 Summary:
  Train: loss=0.0061, dice=0.9935, iou=0.0000, acc=0.0000
  Val:   loss=0.0082, dice=0.9912, iou=0.9826, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 27/50
================================================================================
Epoch 27 [Train]: 100% 479/479 [03:01<00:00,  2.64it/s, loss=0.0085, dice=0.9898]
Epoch 27 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0089, dice=0.9910, iou=0.9821, acc=0.9976]

Epoch 27 Summary:
  Train: loss=0.0060, dice=0.9936, iou=0.0000, acc=0.0000
  Val:   loss=0.0086, dice=0.9909, iou=0.9819, acc=0.9977
  LR: 0.000100

================================================================================
Epoch 28/50
================================================================================
Epoch 28 [Train]: 100% 479/479 [03:01<00:00,  2.65it/s, loss=0.0116, dice=0.9854]
Epoch 28 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0097, dice=0.9899, iou=0.9800, acc=0.9973]

Epoch 28 Summary:
  Train: loss=0.0075, dice=0.9920, iou=0.0000, acc=0.0000
  Val:   loss=0.0096, dice=0.9897, iou=0.9797, acc=0.9975
  LR: 0.000100

================================================================================
Epoch 29/50
================================================================================
Epoch 29 [Train]: 100% 479/479 [03:00<00:00,  2.66it/s, loss=0.0068, dice=0.9923]
Epoch 29 [Val]: 100% 120/120 [00:15<00:00,  7.87it/s, loss=0.0081, dice=0.9918, iou=0.9838, acc=0.9978]

Epoch 29 Summary:
  Train: loss=0.0063, dice=0.9933, iou=0.0000, acc=0.0000
  Val:   loss=0.0080, dice=0.9914, iou=0.9830, acc=0.9979
  LR: 0.000100
  âœ… Saved best model (dice=0.9914) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 30/50
================================================================================
Epoch 30 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0053, dice=0.9941]
Epoch 30 [Val]: 100% 120/120 [00:15<00:00,  7.89it/s, loss=0.0083, dice=0.9917, iou=0.9834, acc=0.9978]

Epoch 30 Summary:
  Train: loss=0.0058, dice=0.9938, iou=0.0000, acc=0.0000
  Val:   loss=0.0080, dice=0.9915, iou=0.9831, acc=0.9979
  LR: 0.000100
  âœ… Saved best model (dice=0.9915) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 31/50
================================================================================
Epoch 31 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0048, dice=0.9946]
Epoch 31 [Val]: 100% 120/120 [00:15<00:00,  7.85it/s, loss=0.0083, dice=0.9918, iou=0.9837, acc=0.9978]

Epoch 31 Summary:
  Train: loss=0.0056, dice=0.9940, iou=0.0000, acc=0.0000
  Val:   loss=0.0082, dice=0.9913, iou=0.9828, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 32/50
================================================================================
Epoch 32 [Train]: 100% 479/479 [03:00<00:00,  2.65it/s, loss=0.0047, dice=0.9945]
Epoch 32 [Val]: 100% 120/120 [00:15<00:00,  7.88it/s, loss=0.0079, dice=0.9920, iou=0.9842, acc=0.9979]

Epoch 32 Summary:
  Train: loss=0.0055, dice=0.9940, iou=0.0000, acc=0.0000
  Val:   loss=0.0081, dice=0.9914, iou=0.9829, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 33/50
================================================================================
Epoch 33 [Train]: 100% 479/479 [03:00<00:00,  2.66it/s, loss=0.0067, dice=0.9933]
Epoch 33 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0082, dice=0.9917, iou=0.9836, acc=0.9978]

Epoch 33 Summary:
  Train: loss=0.0055, dice=0.9941, iou=0.0000, acc=0.0000
  Val:   loss=0.0082, dice=0.9913, iou=0.9828, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 34/50
================================================================================
Epoch 34 [Train]: 100% 479/479 [03:00<00:00,  2.66it/s, loss=0.0056, dice=0.9952]
Epoch 34 [Val]: 100% 120/120 [00:15<00:00,  7.91it/s, loss=0.0077, dice=0.9921, iou=0.9843, acc=0.9979]

Epoch 34 Summary:
  Train: loss=0.0054, dice=0.9941, iou=0.0000, acc=0.0000
  Val:   loss=0.0079, dice=0.9915, iou=0.9832, acc=0.9979
  LR: 0.000100
  âœ… Saved best model (dice=0.9915) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 35/50
================================================================================
Epoch 35 [Train]: 100% 479/479 [03:00<00:00,  2.66it/s, loss=0.0066, dice=0.9926]
Epoch 35 [Val]: 100% 120/120 [00:15<00:00,  7.89it/s, loss=0.0082, dice=0.9914, iou=0.9829, acc=0.9977]

Epoch 35 Summary:
  Train: loss=0.0081, dice=0.9915, iou=0.0000, acc=0.0000
  Val:   loss=0.0085, dice=0.9908, iou=0.9818, acc=0.9977
  LR: 0.000100

================================================================================
Epoch 36/50
================================================================================
Epoch 36 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.0070, dice=0.9915]
Epoch 36 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0086, dice=0.9912, iou=0.9826, acc=0.9977]

Epoch 36 Summary:
  Train: loss=0.0058, dice=0.9937, iou=0.0000, acc=0.0000
  Val:   loss=0.0083, dice=0.9912, iou=0.9826, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 37/50
================================================================================
Epoch 37 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.0053, dice=0.9945]
Epoch 37 [Val]: 100% 120/120 [00:15<00:00,  7.93it/s, loss=0.0078, dice=0.9920, iou=0.9842, acc=0.9979]

Epoch 37 Summary:
  Train: loss=0.0052, dice=0.9944, iou=0.0000, acc=0.0000
  Val:   loss=0.0078, dice=0.9917, iou=0.9835, acc=0.9979
  LR: 0.000100
  âœ… Saved best model (dice=0.9917) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 38/50
================================================================================
Epoch 38 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.0062, dice=0.9937]
Epoch 38 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0078, dice=0.9921, iou=0.9844, acc=0.9979]

Epoch 38 Summary:
  Train: loss=0.0051, dice=0.9945, iou=0.0000, acc=0.0000
  Val:   loss=0.0078, dice=0.9917, iou=0.9835, acc=0.9979
  LR: 0.000100
  âœ… Saved best model (dice=0.9917) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 39/50
================================================================================
Epoch 39 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.0057, dice=0.9943]
Epoch 39 [Val]: 100% 120/120 [00:15<00:00,  7.89it/s, loss=0.0079, dice=0.9919, iou=0.9839, acc=0.9978]

Epoch 39 Summary:
  Train: loss=0.0051, dice=0.9945, iou=0.0000, acc=0.0000
  Val:   loss=0.0080, dice=0.9915, iou=0.9832, acc=0.9979
  LR: 0.000100

================================================================================
Epoch 40/50
================================================================================
Epoch 40 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.0077, dice=0.9899]
Epoch 40 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0081, dice=0.9918, iou=0.9838, acc=0.9978]

Epoch 40 Summary:
  Train: loss=0.0051, dice=0.9945, iou=0.0000, acc=0.0000
  Val:   loss=0.0082, dice=0.9913, iou=0.9828, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 41/50
================================================================================
Epoch 41 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.0060, dice=0.9936]
Epoch 41 [Val]: 100% 120/120 [00:15<00:00,  7.92it/s, loss=0.0089, dice=0.9912, iou=0.9825, acc=0.9977]

Epoch 41 Summary:
  Train: loss=0.0051, dice=0.9945, iou=0.0000, acc=0.0000
  Val:   loss=0.0085, dice=0.9910, iou=0.9822, acc=0.9978
  LR: 0.000100

================================================================================
Epoch 42/50
================================================================================
Epoch 42 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.0034, dice=0.9967]
Epoch 42 [Val]: 100% 120/120 [00:15<00:00,  7.90it/s, loss=0.0081, dice=0.9919, iou=0.9839, acc=0.9979]

Epoch 42 Summary:
  Train: loss=0.0050, dice=0.9946, iou=0.0000, acc=0.0000
  Val:   loss=0.0079, dice=0.9917, iou=0.9835, acc=0.9979
  LR: 0.000100

================================================================================
Epoch 43/50
================================================================================
Epoch 43 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.0051, dice=0.9943]
Epoch 43 [Val]: 100% 120/120 [00:15<00:00,  7.92it/s, loss=0.0079, dice=0.9921, iou=0.9842, acc=0.9979]

Epoch 43 Summary:
  Train: loss=0.0049, dice=0.9947, iou=0.0000, acc=0.0000
  Val:   loss=0.0079, dice=0.9916, iou=0.9834, acc=0.9979
  LR: 0.000050

================================================================================
Epoch 44/50
================================================================================
Epoch 44 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.0050, dice=0.9946]
Epoch 44 [Val]: 100% 120/120 [00:15<00:00,  7.89it/s, loss=0.0074, dice=0.9927, iou=0.9856, acc=0.9981]

Epoch 44 Summary:
  Train: loss=0.0044, dice=0.9953, iou=0.0000, acc=0.0000
  Val:   loss=0.0077, dice=0.9919, iou=0.9840, acc=0.9980
  LR: 0.000050
  âœ… Saved best model (dice=0.9919) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 45/50
================================================================================
Epoch 45 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.0041, dice=0.9954]
Epoch 45 [Val]: 100% 120/120 [00:15<00:00,  7.93it/s, loss=0.0080, dice=0.9923, iou=0.9847, acc=0.9980]

Epoch 45 Summary:
  Train: loss=0.0042, dice=0.9955, iou=0.0000, acc=0.0000
  Val:   loss=0.0077, dice=0.9920, iou=0.9842, acc=0.9980
  LR: 0.000050
  âœ… Saved best model (dice=0.9920) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 46/50
================================================================================
Epoch 46 [Train]: 100% 479/479 [02:59<00:00,  2.67it/s, loss=0.0043, dice=0.9957]
Epoch 46 [Val]: 100% 120/120 [00:15<00:00,  7.94it/s, loss=0.0079, dice=0.9923, iou=0.9848, acc=0.9980]

Epoch 46 Summary:
  Train: loss=0.0041, dice=0.9957, iou=0.0000, acc=0.0000
  Val:   loss=0.0077, dice=0.9921, iou=0.9842, acc=0.9980
  LR: 0.000050
  âœ… Saved best model (dice=0.9921) to /content/checkpoints/brain_unet/brain_unet_best.pth

================================================================================
Epoch 47/50
================================================================================
Epoch 47 [Train]: 100% 479/479 [02:59<00:00,  2.68it/s, loss=0.0051, dice=0.9941]
Epoch 47 [Val]: 100% 120/120 [00:15<00:00,  7.95it/s, loss=0.0079, dice=0.9923, iou=0.9848, acc=0.9980]

Epoch 47 Summary:
  Train: loss=0.0041, dice=0.9957, iou=0.0000, acc=0.0000
  Val:   loss=0.0079, dice=0.9919, iou=0.9839, acc=0.9980
  LR: 0.000050

================================================================================
Epoch 48/50
================================================================================
Epoch 48 [Train]: 100% 479/479 [02:59<00:00,  2.68it/s, loss=0.0047, dice=0.9953]
Epoch 48 [Val]: 100% 120/120 [00:15<00:00,  7.96it/s, loss=0.0079, dice=0.9923, iou=0.9847, acc=0.9980]

Epoch 48 Summary:
  Train: loss=0.0040, dice=0.9957, iou=0.0000, acc=0.0000
  Val:   loss=0.0077, dice=0.9920, iou=0.9841, acc=0.9980
  LR: 0.000050

================================================================================
Epoch 49/50
================================================================================
Epoch 49 [Train]: 100% 479/479 [02:58<00:00,  2.68it/s, loss=0.3295, dice=0.4548]
Epoch 49 [Val]: 100% 120/120 [00:15<00:00,  7.96it/s, loss=0.0077, dice=0.9925, iou=0.9852, acc=0.9980]

Epoch 49 Summary:
  Train: loss=0.0047, dice=0.9946, iou=0.0000, acc=0.0000
  Val:   loss=0.0078, dice=0.9920, iou=0.9842, acc=0.9980
  LR: 0.000050

================================================================================
Epoch 50/50
================================================================================
Epoch 50 [Train]: 100% 479/479 [02:58<00:00,  2.69it/s, loss=0.0040, dice=0.9963]
Epoch 50 [Val]: 100% 120/120 [00:15<00:00,  7.95it/s, loss=0.0079, dice=0.9924, iou=0.9849, acc=0.9980]

Epoch 50 Summary:
  Train: loss=0.0039, dice=0.9958, iou=0.0000, acc=0.0000
  Val:   loss=0.0078, dice=0.9920, iou=0.9841, acc=0.9980
  LR: 0.000050

================================================================================
Training completed! Best Dice: 0.9921
================================================================================

================================================================================
âœ… TRAINING COMPLETED SUCCESSFULLY!
================================================================================

ğŸ“Š Final Results:
   Best Dice Score: 0.9921
   Best model saved to: /content/checkpoints/brain_unet/brain_unet_best.pth
   Last model saved to: /content/checkpoints/brain_unet/brain_unet_last.pth

ğŸ’¾ To download the model:
   from google.colab import files
   files.download('/content/checkpoints/brain_unet/brain_unet_best.pth')
